<!-- add-expense.html -->
<!doctype html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8" />
    <title>Add Expense</title>
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&display=swap" rel="stylesheet">
    <link th:href="@{/style.css}" rel="stylesheet">
</head>
<body>

<!-- NAVBAR -->
<div class="nav">
    <div class="brand">
        <div class="logo">ES</div>
        <div class="app-name">Expense Splitter</div>
    </div>
    <div class="nav-right">
        <a th:href="@{/DASHBOARD}">Dashboard</a>
        <div class="profile-chip" th:text="${user.name}">User</div>
    </div>
</div>

<div class="container">
    <div class="card" style="max-width:720px;margin:18px auto">
        <h3 style="margin-top:0">Add Expense</h3>

        <!-- FORM -->
        <form th:action="@{/addexpense}" method="post">

            <!-- DESCRIPTION -->
            <label class="small">Description</label>
            <input class="input" name="description" placeholder="e.g., Pizza" required />

            <!-- AMOUNT -->
            <label class="small">Amount</label>
            <input class="input" name="amount" placeholder="Enter amount" type="number" required />

            <div style="display:flex;gap:12px;align-items:center;margin-top:8px">
                <!-- PAID BY -->
                <div style="flex:1">
                    <label class="small">Paid by</label>
                    <select class="input" name="paidBy">
                        <option th:each="member : ${members}"
                                th:value="${member.id}"
                                th:text="${member.name}">Member</option>
                    </select>
                </div>

                <!-- SPLIT MODE -->
                <div style="width:180px">
                    <label class="small">Split</label>
                    <select class="input" name="splitMode" id="splitMode" onchange="toggleCustom()">
                        <option value="equal">Split equally</option>
                        <option value="custom">Custom split</option>
                    </select>
                </div>
            </div>

            <!-- CUSTOM SPLIT -->
            <div id="customSplit" style="display:none;margin-top:12px">
                <div class="small">Enter share for each member</div>
                <div class="checkbox-grid" style="margin-top:8px">
                    <div th:each="member : ${members}">
                        <input class="small-input"
                               th:name="'customShare[' + ${member.id} + ']'"
                               th:placeholder="${member.name} share"
                               type="number" min="0" />
                    </div>
                </div>
            </div>

            <!-- BUTTONS -->
            <div style="margin-top:18px;display:flex;gap:10px">
                <button type="submit" class="primary-btn">Add Expense</button>
                <a th:href="@{/group/{id}(id=${group.id})}"
                   class="primary-btn"
                   style="background:#fff;color:var(--primary);
                          border:1px solid rgba(90,103,216,0.12);
                          text-decoration:none;padding:10px 12px;display:inline-block">
                    Cancel
                </a>
            </div>

        </form>

        <div id="msg" style="margin-top:12px;color:var(--muted)" th:text="${msg}"></div>
    </div>
</div>

<script>
    function toggleCustom(){
        const mode = document.getElementById('splitMode').value;
        document.getElementById('customSplit').style.display = mode === 'custom' ? 'block' : 'none';
    }
</script>

</body>
</html>
